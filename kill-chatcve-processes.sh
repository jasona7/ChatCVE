#!/bin/bash

# Kill ChatCVE processes occupying ports
echo "ðŸ” Finding ChatCVE processes..."

# Find processes on ChatCVE ports
PROCESSES=$(sudo netstat -tulnp | grep -E ':(300[0-9]|5000)' | awk '{print $7}' | cut -d'/' -f1 | sort -u | grep -v '^$')

if [ -z "$PROCESSES" ]; then
    echo "âœ… No processes found on ChatCVE ports (3000-3009, 5000)"
    exit 0
fi

echo "Found processes on ChatCVE ports:"
sudo netstat -tulnp | grep -E ':(300[0-9]|5000)'

echo ""
echo "ðŸ”ª Killing processes: $PROCESSES"
for PID in $PROCESSES; do
    if [ "$PID" != "" ]; then
        echo "Killing PID: $PID"
        sudo kill -9 $PID 2>/dev/null || echo "  (already dead)"
    fi
done

echo ""
echo "âœ… Done! Ports should now be free:"
sudo netstat -tulnp | grep -E ':(300[0-9]|5000)' || echo "All ChatCVE ports are now available"

